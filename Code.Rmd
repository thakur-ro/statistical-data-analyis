---
title: "Applied_Stats_Project"
author: "Rohit Thakur"
date: "12/2/2020"
output: html_document
---
Installing packages and dependencies
```{r}
library(readr)
library(ggplot2)
library(tidyverse)
library(modelr)
```
ANOVA ANALYSIS: By Elizabeth Trauger
```{r}
#Clear workspace
rm(list=ls())
#import dataset
library(psych)
dir<-"C:/Users/rthak/Downloads"
var<-"student-mat"
df<-read_csv(file.path(dir,paste0(var,".csv")))
df<- df %>%
  mutate(score = (G1+G2+G3)/3)

hist(df$score, freq = F,xlab='Math Score', main=NULL)
curve(dnorm(x, mean=mean(df$score), sd=sd(df$score)),col=2,add=TRUE)

```
Anova tests for the variables famsize, sex, higher, famsup and schoolsup
```{r}
df$famsize<-as.factor(df$famsize)
summary(aov(score~famsize, data=df))

df$sex<-as.factor(df$sex)
summary(aov(score~sex, data=df))

df$higher<-as.factor(df$higher)
summary(aov(score~higher, data=df))

df$famsup<-as.factor(df$famsup)
summary(aov(score~famsup, data=df))

df$schoolsup<-as.factor(df$schoolsup)
summary(aov(score~schoolsup, data=df))
```

Descriptive statistics for the variables sex, higher, schoolsup, and famsize
```{r}

describeBy(df$score, df$sex)
describeBy(df$score, df$higher)
describeBy(df$score, df$schoolsup)
describeBy(df$score, df$famsup)
describeBy(df$score, df$famsize)
```

ANOVA ANALYSIS and PAIRWISE COMPARISON STUDY Continued:
By Regan Kelly
```{r}

#Address and romantic are categorical (factors) variables - grouping variables
df$address<-as.factor(df$address)
df$romantic<-as.factor(df$romantic)

#For address variable, fit by a linear model aov(), then produce the ANOVA table
fit1=aov(score~address, data=df)
#One-way ANOVA of average math score over address
anova(fit1)

#Summary statistics by address
describeBy(df$score,df$address)

#For romantic variable, fit by a linear model aov(), then produce the ANOVA table
fit2=aov(score~romantic, data=df)
#One-way ANOVA of average math score over romantic
anova(fit2)

#Summary statistics by romantic status
describeBy(df$score,df$romantic)

#Study time is categorical (factor) variable - grouping variable
df$studytime<-as.factor(df$studytime)

#For studytime variable, fit by a linear model aov(), then produce the ANOVA table
fit3=aov(score~studytime, data=df)

#One-way ANOVA of average math score over studytime (can do with either command)
anova(fit3)

#Multiple pairwise comparison
#Tukey's HSD adjustment for multiple comparison
TukeyHSD(fit3, conf.level=0.95)

#Check ANOVA assumptions
#Check assumption of equal variance
#Plot residuals versus predicted values
plot(fit1, which=1)
plot(fit2, which=1)
plot(fit3, which=1)

```


Regression Analysis: By Rohit Thakur

```{r}
#removing NAs if any
math_scores<-as_tibble(na.omit(df))
print(math_scores)
```
Creating target variable as average math score
```{r}
drops <- c("G1","G2","G3")
#removing G1,G2 and G3 since we added score as average of those three
df<-df[ , !(names(df) %in% drops)]
```



Visualizations to identify interesting relationships in datasets
```{R}
#Are number of absences related to health?

#Number of students in different health categories
math_scores%>%
  ggplot(aes(x=health))+
  geom_bar()+
  labs(x="Health Categories(5-healthiest)", y="count",
       title="Majority of students have good health")+
  theme_minimal()
```
```{r}
#Number of absences for each school
math_scores%>%
  ggplot(aes(x=absences,fill=as.factor(school)))+
  geom_density(alpha=0.5)+
  labs(x="Number of Absences",
       title="Distribution of number of absences in each school within each health group")+
  facet_wrap(~health)+
  guides(fill=guide_legend(title="schools"))+
  theme_light()
```
Which school has higher average math score
```{r}
math_scores%>%
  ggplot(aes(x=score,y=school))+
  geom_jitter()+
  geom_boxplot()+
  labs(x="Average Math Score",y="School",
       title="School GP has higher median Math Score")+
  theme_minimal()
```
How study time and romantic relationship affect math score
```{r}
df%>%
  select(studytime,romantic,score)%>%
  ggplot(aes(x=studytime,y=score,group=studytime))+
  geom_jitter()+
  geom_boxplot()+
  labs(x="Study time",y="Average Math Score",
       title="Math score is affected by romantic relationship")+
  facet_wrap(~romantic)+
  theme_light()
```
How extra curricular activities affect math scores
```{r}
df%>%
  select(activities,score)%>%
  ggplot(aes(x=score))+
  geom_histogram()+
  facet_wrap(~activities)+
  labs(x="Average Math Score",y="Count",
       title="Distribution of Average math score is\nright skewed for students performing activities")+
  theme_minimal()
  
```
Stepwise model selection based on AIC score
Multiple linear regression
```{r}
#multiple linear regression
model_fit<-lm(score~.,data=df)
step(model_fit)
```

Based on ANOVA results we finetune our model given by step function
to include following features
```{r}
#Final Model
model_fit1<-lm(formula = score ~ sex + Medu + studytime + 
    failures + schoolsup + famsup + goout , data = df)
summary(model_fit1)
```
Checking if any assumptions are violated
```{r}
plot(model_fit1)
```














